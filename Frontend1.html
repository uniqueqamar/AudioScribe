<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scriptify | High-Fidelity Audio</title>
    <style>
        /* 1. GLOBAL STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, sans-serif;
        }

        :root {
            --primary: #3a4bb0;
            --secondary: #8fd3f4;
            --white: #ffffff;
            --glass: rgba(255, 255, 255, 0.1);
        }

        html { scroll-behavior: smooth; }

        body {
            background: linear-gradient(135deg, #3a4bb0, #8fd3f4);
            background-attachment: fixed; /* Keeps gradient steady while scrolling */
            color: var(--white);
            overflow-x: hidden;
        }

        /* 2. HERO SECTION */
        .hero-header {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        #waveCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 10;
            padding: 20px;
            pointer-events: none;
        }

        h7 {
            display: block;
            text-transform: uppercase;
            letter-spacing: 5px;
            font-size: 0.9rem;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        h1 {
            font-size: clamp(3.5rem, 12vw, 7rem);
            font-weight: 900;
            letter-spacing: -2px;
            margin-bottom: 20px;
            line-height: 1;
        }

        /* 3. BUTTONS (Animated Pop-up) */
        .cta-button {
            position: relative;
            z-index: 20;
            pointer-events: auto;
            padding: 18px 45px;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            background: var(--white);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-decoration: none;
            display: inline-block;
        }

        .cta-button:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 15px 30px rgba(58, 75, 176, 0.4);
        }

        /* 4. CONTENT SECTIONS */
        section.info-section {
            position: relative;
            z-index: 10;
            padding: 100px 10%;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            justify-content: center;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            padding: 40px;
            border-radius: 20px;
            width: 300px;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.1);
        }

        .card h3 { margin-bottom: 15px; font-size: 1.5rem; }
        .card p { opacity: 0.8; line-height: 1.6; }

        footer {
            padding: 50px;
            text-align: center;
            font-size: 0.9rem;
            opacity: 0.6;
        }
        /* Upload Bar Styling */
.upload-container {
    padding: 60px 20px;
    display: flex;
    justify-content: center;
    position: relative;
    z-index: 30;
}

.input-wrapper {
    background: rgba(255, 255, 255, 0.95);
    width: 100%;
    max-width: 700px;
    padding: 12px 20px;
    border-radius: 30px;
    display: flex;
    align-items: center;
    gap: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    transition: transform 0.3s ease;
}

.input-wrapper:hover {
    transform: translateY(-2px);
}

/* Plus Button & Popup Menu */
.plus-menu-container {
    position: relative;
}

.plus-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: none;
    background: #f0f2f5;
    color: #5f6368;
    font-size: 24px;
    cursor: pointer;
    transition: background 0.2s, transform 0.3s;
}

.plus-btn:hover { background: #e4e6e9; transform: rotate(90deg); }

.popup-menu {
    position: absolute;
    bottom: 60px; /* Opens Upward */
    left: 0;
    background: white;
    border-radius: 12px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    width: 160px;
    display: none; /* Hidden by default */
    flex-direction: column;
    overflow: hidden;
    animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.menu-item {
    padding: 12px 16px;
    color: #3c4043;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.2s;
}

.menu-item:hover { background: #f8f9fa; }

/* Input Area */
.input-area {
    flex-grow: 1;
    color: #80868b; /* Greyish tone */
    font-size: 16px;
    user-select: none;
}

/* Upload Button */
.upload-btn {
    background: var(--primary);
    color: white;
    border: none;
    padding: 10px 24px;
    border-radius: 20px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.upload-btn:hover {
    background: #2a3a8c;
    transform: scale(1.05); /* Animated pop-up hover */
}
.glass-panel {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 30px;
    padding: 40px;
    width: 100%;
    max-width: 800px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
}

.studio-header { display: flex; justify-content: space-between; margin-bottom: 20px; }
.badge { background: var(--primary); padding: 4px 12px; border-radius: 20px; font-size: 0.7rem; }

.text-preview {
    background: rgba(0, 0, 0, 0.2);
    padding: 20px;
    border-radius: 15px;
    margin-bottom: 30px;
    font-style: italic;
    color: #e0e0e0;
}

/* Spinner Animation */
.spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.3);
    border-top: 5px solid white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 20px;
}

@keyframes spin { 100% { transform: rotate(360deg); } }

.player-controls {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 30px;
}

.play-btn {
    background: white;
    border: none;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    font-size: 1.5rem;
    cursor: pointer;
    transition: transform 0.2s;
}

.play-btn:hover { transform: scale(1.1); }

.progress-bar-container {
    flex-grow: 1;
    height: 6px;
    background: rgba(255,255,255,0.2);
    border-radius: 10px;
    overflow: hidden;
}

.progress-fill { width: 40%; height: 100%; background: var(--secondary); }

.action-row { display: flex; gap: 15px; justify-content: center; }
.cta-button.secondary { background: transparent; border: 2px solid white; color: white; }
/* Visualizer Bars */
.visualizer-container {
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 3px;
    margin-bottom: 20px;
    background: rgba(0, 0, 0, 0.1);
    border-radius: 15px;
    padding: 10px;
}

.v-bar {
    width: 4px;
    height: 20%;
    background: rgba(255, 255, 255, 0.2); /* Light background for unplayed */
    border-radius: 2px;
    transition: background 0.1s, height 0.2s;
}

.v-bar.active {
    background: var(--secondary); /* Darkens/Colors as audio progresses */
}

/* Premium Slider Styling */
.speed-slider-wrapper {
    margin-bottom: 25px;
    animation: fadeIn 0.4s ease;
}

.premium-slider {
    -webkit-appearance: none;
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 5px;
    outline: none;
    margin-top: 15px;
}

.premium-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    background: white;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
    border: 2px solid var(--primary);
}

@keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .history-section {
    padding: 80px 10%;
    background: rgba(0, 0, 0, 0.1);
    backdrop-filter: blur(5px);
}

.history-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}

.carousel-controls { display: flex; gap: 10px; }

.nav-btn {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    cursor: pointer;
    transition: 0.3s;
    font-size: 1.2rem;
}

.nav-btn:hover { background: white; color: var(--primary); transform: scale(1.1); }

.carousel-viewport {
    width: 100%;
    overflow: hidden; /* Clips the extra cards */
}

.carousel-track {
    display: flex;
    gap: 20px;
    transition: transform 0.5s cubic-bezier(0.25, 1, 0.5, 1);
    will-change: transform;
}

.history-card {
    min-width: calc(25% - 15px); /* Exactly 4 cards visible */
    background: rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    padding: 15px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: 0.3s;
}

.history-card:hover { transform: translateY(-5px); background: rgba(255,255,255,0.15); }

.thumb-wrapper {
    position: relative;
    width: 100%;
    height: 150px;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 12px;
}

.thumb-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(0.8);
}

.replay-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    color: var(--primary);
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    opacity: 0;
    transition: 0.3s;
}

.history-card:hover .replay-overlay { opacity: 1; }

.card-info h4 { font-size: 0.95rem; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-info p { font-size: 0.8rem; opacity: 0.6; }
.quiz-container {
    border-top: 2px solid var(--secondary);
}

.question-block {
    text-align: left;
    margin-bottom: 25px;
    background: rgba(0, 0, 0, 0.2);
    padding: 20px;
    border-radius: 15px;
    animation: fadeIn 0.5s ease;
}

.question-text {
    font-size: 1.1rem;
    margin-bottom: 15px;
    font-weight: 600;
}

.options-grid {
    display: grid;
    gap: 10px;
}

.option-label {
    background: rgba(255, 255, 255, 0.05);
    padding: 12px 20px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
}

.option-label:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateX(5px);
}

/* Hide actual radio button but keep functionality */
.option-label input {
    margin-right: 15px;
    accent-color: var(--secondary);
}

.correct-flash { background: rgba(76, 175, 80, 0.3) !important; border-color: #4CAF50 !important; }
.wrong-flash { background: rgba(244, 67, 54, 0.3) !important; border-color: #F44336 !important; }
.option-label {
    /* ... existing styles ... */
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Add a subtle checkmark color when selected */
.option-label input:checked + span {
    color: var(--secondary);
    font-weight: bold;
}
    </style>
</head>
<body>

    <section class="hero-header">
        <canvas id="waveCanvas"></canvas>
        <div class="hero-content">
            <h7>Read Aloud</h7>
            <h1>SCRIPTIFY</h1>
            <p style="margin-bottom: 40px; font-size: 1.2rem;">Experience the next generation of audio precision.</p>
            <a href="#features" class="cta-button">Explore Features</a>
        </div>
    </section>
    <section class="upload-container">
    <div class="input-wrapper">
        <div class="plus-menu-container">
            <button class="plus-btn" id="plusBtn" title="Add Content">+</button>
            <div class="popup-menu" id="popupMenu">
                <div class="menu-item"><i class="icon">üìÑ</i> Add Files</div>
                <div class="menu-item"><i class="icon">üì∑</i> Attach Photo</div>
            </div>
        </div>
        <div class="input-area">
            <span id="placeholderText">Add your notes...</span>
            <input type="file" id="fileInput" hidden>
        </div>
        <button class="upload-btn" id="uploadBtn">Upload</button>
    </div>
</section>

    <section id="features" class="info-section">
        <div class="card">
            <h3>Neural Sound</h3>
            <p>AI-driven audio processing that cleans and enhances every script read.</p>
        </div>
        <div class="card">
            <h3>Real-time Sync</h3>
            <p>Perfectly synchronized audio waves that respond to your voice inputs.</p>
        </div>
        <div class="card">
            <h3>Studio Quality</h3>
            <p>Export high-bitrate audio files directly to your cloud storage.</p>
        </div>
    </section>
    <section id="studioSection" class="info-section" style="display: none; flex-direction: column; align-items: center;">
    <div class="glass-panel">
        <div class="processing-loader" id="loader">
            <div class="spinner"></div>
            <p>AI is analyzing your notes...</p>
        </div>

        <div id="audioPlayerUI" style="display: none; width: 100%;">
    <div class="studio-header">
        <h2>Generated Audio</h2>
        <span class="badge">Neural Voice - v2.4</span>
    </div>
    
    <div class="visualizer-container" id="visualizer">
        </div>

    <div class="player-controls">
        <button class="play-btn" id="masterPlayBtn">‚ñ∂</button>
        <div class="progress-bar-container">
            <div class="progress-fill" id="audioProgress"></div>
        </div>
        <span class="time" id="timeDisplay">00:00</span>
    </div>

    <div id="speedControl" class="speed-slider-wrapper" style="display: none;">
        <label>Speed: <span id="speedValue">1x</span></label>
        <input type="range" min="0.75" max="1.5" step="0.25" value="1" id="playbackSlider" class="premium-slider">
    </div>

    <div class="action-row">
        <button class="cta-button secondary" id="speedToggleBtn">Playback Speed</button>
        <button class="cta-button">Download MP3</button>
    </div>
</div>
    </div>
</section>
<section id="quizSection" class="info-section" style="display: none; flex-direction: column; align-items: center;">
    <div class="glass-panel quiz-container">
        <div class="studio-header">
            <h2>Test Your Knowledge</h2>
            <button class="cta-button" id="generateQuizBtn" style="padding: 10px 25px; font-size: 0.9rem;">Generate Quiz</button>
        </div>

        <div id="quizLoader" style="display: none; text-align: center; padding: 20px;">
            <div class="spinner"></div>
            <p>AI is drafting questions from your notes...</p>
        </div>

        <div id="quizContent" style="display: none;">
            <div id="questionArea"></div>
            <div class="action-row" style="margin-top: 30px;">
                <button class="cta-button" id="submitQuizBtn">Check Answers</button>
                <button class="cta-button secondary" id="resetQuizBtn">New Questions</button>
            </div>
        </div>
        
        <div id="quizFeedback" style="display: none; margin-top: 20px; text-align: center; font-weight: bold;"></div>
    </div>
</section>
<section id="history" class="history-section">
    <div class="history-header">
        <h2>Your Studio History</h2>
        <div class="carousel-controls">
            <button class="nav-btn prev" id="prevBtn">‚Üê</button>
            <button class="nav-btn next" id="nextBtn">‚Üí</button>
        </div>
    </div>

    <div class="carousel-viewport">
        <div class="carousel-track" id="historyTrack">
            <div class="history-card">
                <div class="thumb-wrapper">
                    <img src="https://images.unsplash.com/photo-1517842645767-c639042777db?auto=format&fit=crop&w=300" alt="Scan 1">
                    <button class="replay-overlay">‚ñ∂</button>
                </div>
                <div class="card-info">
                    <h4>Lecture_Notes_01.jpg</h4>
                    <p>Feb 07, 2026</p>
                </div>
            </div>
            <div class="history-card">
                <div class="thumb-wrapper">
                    <img src="https://images.unsplash.com/photo-1506784983877-45594efa4cbe?auto=format&fit=crop&w=300" alt="Scan 2">
                    <button class="replay-overlay">‚ñ∂</button>
                </div>
                <div class="card-info">
                    <h4>Meeting_Minutes.png</h4>
                    <p>Feb 06, 2026</p>
                </div>
            </div>
            <div class="history-card">
                <div class="thumb-wrapper">
                    <img src="https://images.unsplash.com/photo-1455390582262-044cdead277a?auto=format&fit=crop&w=300" alt="Scan 3">
                    <button class="replay-overlay">‚ñ∂</button>
                </div>
                <div class="card-info">
                    <h4>Poem_Draft.jpg</h4>
                    <p>Feb 05, 2026</p>
                </div>
            </div>
            <div class="history-card">
                <div class="thumb-wrapper">
                    <img src="https://images.unsplash.com/photo-1516979187457-637abb4f9353?auto=format&fit=crop&w=300" alt="Scan 4">
                    <button class="replay-overlay">‚ñ∂</button>
                </div>
                <div class="card-info">
                    <h4>Research_Summary.jpg</h4>
                    <p>Feb 04, 2026</p>
                </div>
            </div>
            <div class="history-card">
                <div class="thumb-wrapper">
                    <img src="https://images.unsplash.com/photo-1503551723145-6c040742065b?auto=format&fit=crop&w=300" alt="Scan 5">
                    <button class="replay-overlay">‚ñ∂</button>
                </div>
                <div class="card-info">
                    <h4>Project_Idea.png</h4>
                    <p>Feb 03, 2026</p>
                </div>
            </div>
        </div>
    </div>
</section>
    <footer>
        <p>&copy; 2026 SCRIPTIFY Audio Labs. All rights reserved.</p>
    </footer>

    <script>
//         const cors = require('cors');
// app.use(cors()); // This must come BEFORE your routes
        /* WAVE ANIMATION LOGIC */
        const canvas = document.getElementById('waveCanvas');
        const ctx = canvas.getContext('2d');
        let width, height, time = 0;
        let mouse = { x: 0, y: 0, active: false };

        const waveLayers = [
            { freq: 0.001, amp: 120, speed: 0.02, color: [255, 255, 255] },
            { freq: 0.002, amp: 80,  speed: 0.05, color: [106, 133, 255] },
            { freq: 0.003, amp: 150, speed: 0.01, color: [255, 255, 255] },
            { freq: 0.0015, amp: 100, speed: 0.03, color: [58, 75, 176] }
        ];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            if(!mouse.active){ mouse.x = width/2; mouse.y = height/2; }
        }

        window.addEventListener('resize', resize);
        window.addEventListener('mousemove', e => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
            mouse.active = true;
        });

        function animate() {
            ctx.clearRect(0, 0, width, height);
            time += 1;

            waveLayers.forEach((wave, i) => {
                ctx.beginPath();
                ctx.lineWidth = i % 2 === 0 ? 4 : 2;
                
                const xEffect = mouse.x / width;
                const r = Math.floor(wave.color[0] * (1 - xEffect) + 58 * xEffect);
                const g = Math.floor(wave.color[1] * (1 - xEffect) + 75 * xEffect);
                const b = Math.floor(wave.color[2] * (1 - xEffect) + 176 * xEffect);
                
                ctx.strokeStyle = `rgba(${r}, ${g}, ${b}, 0.6)`;
                ctx.shadowBlur = 15;
                ctx.shadowColor = `rgba(${r}, ${g}, ${b}, 0.5)`;

                const dynamicAmp = wave.amp + (1 - (mouse.y / height)) * 180;

                for (let x = 0; x <= width; x += 3) {
                    const y = (height / 2) + Math.sin(x * wave.freq + (time * wave.speed)) * dynamicAmp;
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            });
            requestAnimationFrame(animate);
        }

        resize();
        animate();
        // Functionality for the Note Upload Bar
const plusBtn = document.getElementById('plusBtn');
const popupMenu = document.getElementById('popupMenu');
const placeholderText = document.getElementById('placeholderText');
const uploadBtn = document.getElementById('uploadBtn');

// Toggle the Upward Menu
plusBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    popupMenu.style.display = popupMenu.style.display === 'flex' ? 'none' : 'flex';
});

// Close menu when clicking elsewhere
document.addEventListener('click', () => {
    popupMenu.style.display = 'none';
});

// Mocking the "Upload" and vanishing text
// Find your menu items and add the click event
const menuItems = document.querySelectorAll('.menu-item');
const realFileInput = document.getElementById('fileInput'); // The hidden input

menuItems.forEach(item => {
    item.addEventListener('click', () => {
        realFileInput.click(); // This opens the actual file browser
        popupMenu.style.display = 'none'; // Close the menu
    });
});

// When a user actually selects a file, update the text
realFileInput.addEventListener('change', () => {
    if (realFileInput.files.length > 0) {
        placeholderText.textContent = "File selected: " + realFileInput.files[0].name;
        placeholderText.style.color = "#3a4bb0";
        placeholderText.style.fontWeight = "bold";
    }
});



uploadBtn.addEventListener('click', async () => {
    const fileInput = document.getElementById('fileInput');
    if (!fileInput.files[0]) return alert("Select a file!");

    uploadBtn.textContent = "Processing...";
    const formData = new FormData();
    formData.append('noteImage', fileInput.files[0]);

    try {
        // STEP 1: Process File (OCR + Audio)
        const ocrResponse = await fetch('http://localhost:3000/process-notes', {
            method: 'POST',
            body: formData
        });

        if (!ocrResponse.ok) throw new Error("Upload Failed");
        
        const ocrData = await ocrResponse.json(); // Read ONLY ONCE

        // STEP 2: Update Transcription Text
        // Note: Ensure you have an element with ID 'transcriptionText' in your HTML
        const transcriptEl = document.getElementById('transcriptionText');
        if(transcriptEl) transcriptEl.innerText = ocrData.text;

        // STEP 3: Setup Audio
        const audioPlayer = new Audio(ocrData.audioUrl);
        masterPlayBtn.onclick = () => {
            if (audioPlayer.paused) {
                audioPlayer.play();
                masterPlayBtn.textContent = '‚è∏';
                isPlaying = true; // Sync with your visualizer logic
                updatePlayback(); 
            } else {
                audioPlayer.pause();
                masterPlayBtn.textContent = '‚ñ∂';
                isPlaying = false;
            }
        };

        // STEP 4: Generate Quiz based on that text
        const quizResponse = await fetch('http://localhost:3000/generate-quiz', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ text: ocrData.text })
        });
        
        window.currentQuiz = await quizResponse.json(); 

        // STEP 5: Reveal UI
        studioSection.style.display = 'flex';
        quizSection.style.display = 'flex';
        loader.style.display = 'none';
        audioPlayerUI.style.display = 'block';
        uploadBtn.textContent = "Success!";
        studioSection.scrollIntoView({ behavior: 'smooth' });

    } catch (err) {
        console.error("Critical Error:", err);
        uploadBtn.textContent = "Error";
    }
});

async function startProcessing() {
    const fileInput = document.getElementById('fileInput'); // Ensure you have an <input type="file">
    if (!fileInput.files[0]) return alert("Select a file first!");

    const formData = new FormData();
    formData.append('noteImage', fileInput.files[0]);

    document.getElementById('status').innerText = "Uploading to server...";

    try {
        const response = await fetch('http://localhost:3000/upload', {
            method: 'POST',
            body: formData
        });

        const result = await response.json();
        console.log(result);

        // Success! Now show the studio
        document.getElementById('studio').style.display = 'flex';
        window.scrollTo(0, document.getElementById('studio').offsetTop - 50);
        initViz();
    } catch (error) {
        console.error("Upload failed:", error);
    }
}
const speedToggleBtn = document.getElementById('speedToggleBtn');
const speedControl = document.getElementById('speedControl');
const playbackSlider = document.getElementById('playbackSlider');
const speedValue = document.getElementById('speedValue');
const visualizer = document.getElementById('visualizer');
const masterPlayBtn = document.getElementById('masterPlayBtn');
const audioProgress = document.getElementById('audioProgress');
const studioSection = document.getElementById('studioSection');
const loader = document.getElementById('loader');
const audioPlayerUI = document.getElementById('audioPlayerUI');
<p id="transcriptionText" style="color: white; margin: 10px 0; opacity: 0.8;"></p>

// 1. Generate Visualizer Bars
for (let i = 0; i < 40; i++) {
    const bar = document.createElement('div');
    bar.className = 'v-bar';
    // Randomize initial heights for a "recorded" look
    bar.style.height = Math.random() * 80 + 20 + '%';
    visualizer.appendChild(bar);
}

// 2. Toggle Speed Slider
speedToggleBtn.addEventListener('click', () => {
    speedControl.style.display = speedControl.style.display === 'none' ? 'block' : 'none';
});

// 3. Update Speed Value
playbackSlider.addEventListener('input', (e) => {
    speedValue.textContent = e.target.value + 'x';
});

// 4. Playback Logic (Visualizer & Progress)
let isPlaying = false;
let progress = 0;

masterPlayBtn.addEventListener('click', () => {
    isPlaying = !isPlaying;
    masterPlayBtn.textContent = isPlaying ? '‚è∏' : '‚ñ∂';
    if (isPlaying) updatePlayback();
});

function updatePlayback() {
    if (!isPlaying) return;

    progress += (0.2 * playbackSlider.value); // Speed affects progress rate
    audioProgress.style.width = progress + '%';

    // Color the bars as progress moves
    const bars = document.querySelectorAll('.v-bar');
    const activeIndex = Math.floor((progress / 100) * bars.length);
    
    bars.forEach((bar, index) => {
        if (index <= activeIndex) {
            bar.classList.add('active');
            // Animate height while playing
            bar.style.height = Math.random() * 80 + 20 + '%';
        } else {
            bar.style.height = '30%'; // Static height for unplayed
        }
    });

    if (progress < 100) {
        requestAnimationFrame(updatePlayback);
    } else {
        isPlaying = false;
        masterPlayBtn.textContent = '‚ñ∂';
        progress = 0;
    }
}
const track = document.getElementById('historyTrack');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');

let currentScroll = 0;
const cardWidth = 100 / 4; // Percentage of the viewport per card

nextBtn.addEventListener('click', () => {
    const maxScroll = (track.children.length - 4) * (track.offsetWidth / 4 + 20); 
    // Simplified logic: move by one card width + gap
    const moveAmount = track.offsetWidth / 4 + 20;
    
    if (Math.abs(currentScroll) < maxScroll) {
        currentScroll -= moveAmount;
        track.style.transform = `translateX(${currentScroll}px)`;
    }
});

prevBtn.addEventListener('click', () => {
    const moveAmount = track.offsetWidth / 4 + 20;
    
    if (currentScroll < 0) {
        currentScroll += moveAmount;
        track.style.transform = `translateX(${currentScroll}px)`;
    }
});
const generateQuizBtn = document.getElementById('generateQuizBtn');
const quizSection = document.getElementById('quizSection');
const quizLoader = document.getElementById('quizLoader');
const quizContent = document.getElementById('quizContent');
const questionArea = document.getElementById('questionArea');
const submitQuizBtn = document.getElementById('submitQuizBtn');
const quizFeedback = document.getElementById('quizFeedback');

// Mock Data (In production, this comes from your LLM API)
async function fetchQuizFromLLM(transcribedText) {
    const API_URL = "YOUR_BACKEND_ENDPOINT_OR_LLM_URL"; // e.g., OpenAI or Google Vertex
    
    try {
        const response = await fetch(API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt: "Generate 3 MCQs for: " + transcribedText })
        });
        
        const data = await response.json();
        // data would now be the array of 3 questions
        renderQuiz(data); 
    } catch (error) {
        console.error("LLM Error:", error);
        // Fallback to mock data if API fails
        renderQuiz(mockQuestions);
    }
}

// 1. Show Quiz Section after successful upload (Add this to your existing uploadBtn listener)
// studioSection.style.display = 'flex'; -> quizSection.style.display = 'flex';

generateQuizBtn.addEventListener('click', () => {
    generateQuizBtn.style.display = 'none';
    quizLoader.style.display = 'block';

    // Simulate API Delay
    setTimeout(() => {
        quizLoader.style.display = 'none';
        quizContent.style.display = 'block';
        renderQuiz();
    }, 2000);
});

function renderQuiz() {
    questionArea.innerHTML = '';
    mockQuestions.forEach((item, index) => {
        const qBlock = document.createElement('div');
        qBlock.className = 'question-block';
        qBlock.innerHTML = `
            <p class="question-text">${index + 1}. ${item.q}</p>
            <div class="options-grid">
                ${item.options.map((opt, i) => `
                    <label class="option-label">
                        <input type="radio" name="q${index}" value="${i}">
                        ${opt}
                    </label>
                `).join('')}
            </div>
        `;
        questionArea.appendChild(qBlock);
    });
}

submitQuizBtn.addEventListener('click', () => {
    let score = 0;
    mockQuestions.forEach((item, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        const labels = document.querySelectorAll(`.question-block:nth-child(${index+1}) .option-label`);
        
        if (selected) {
            if (parseInt(selected.value) === item.correct) {
                score++;
                labels[item.correct].classList.add('correct-flash');
            } else {
                labels[selected.value].classList.add('wrong-flash');
                labels[item.correct].classList.add('correct-flash');
            }
        }
    });

    quizFeedback.style.display = 'block';
    quizFeedback.textContent = `You scored ${score} out of ${mockQuestions.length}!`;
    quizFeedback.style.color = score === 3 ? "#4CAF50" : "#ffffff";
});
function renderQuiz() {
    const questions = window.currentQuiz || mockQuestions; // Use real data if available
    questionArea.innerHTML = '';
    
    questions.forEach((item, index) => {
        // ... (your existing rendering code)
    });
}
    </script>
</body>
</html>